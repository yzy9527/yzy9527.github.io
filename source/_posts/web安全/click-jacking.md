---
title: 点击劫持
date: 2020-12-3 22:31:11
categories:
 - Web安全
---
点击劫持是一种“诱骗”用户在不知情的情况下点击恶意网站的方式。

1. 访问者进入到恶意网站，恶意网站中含有引导用户点击的链接或按钮。
2. 在该链接和按钮上方含有一个透明的`iframe`,其`src`来自攻击者想要攻击的网站
3. 用户点击链接或按钮时，实际点击了`iframe`内的按钮后链接。

## 点击劫持防御

### top
根据js进行判断是否被劫持，如果被劫持就跳走
 ```js
    if(top.location != window.location){
        top.location = window.location
    }
```

### sandbox
 
 允许form提交，但会导致很多脚本，图标等无法显示，没有加入到允许名单；禁用js后，点击劫持也还有可能存在

```js
    <iframe sandbox="allow-forms"/>
```

 > js无法百分比的解决劫持问题
 
### X-Frame-Options（推荐）
 
决定这个网站是否允许内嵌，当我们设置该网站不允许内嵌时，浏览器就会不让它内嵌，从而防御点击劫持

 - SAME-ORIGIN 嵌入页和被嵌入页在同一个域下
 - ALLOW-FROM 只允许指定的网站对本网站内嵌
 - DENY 不允许网站进行内嵌
 
### 其它辅助手段

如使用验证码，只有用户输入了验证码才可以进行点击，但这会提高用户的操作门槛，同时iframe也可能会变身为另一种形式让你输入验证码；总之用户的操作成本提高，就会在一定层度上减小点击劫持的风险，但这也仅仅只是辅助手段，并不能从根本上解决点击劫持
 
 